{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AÂ³ AI Resume Intelligence</title>

    <link rel="icon" type="image/svg+xml" href="{% static 'a3-favicon.svg' %}">
    <link rel="stylesheet" href="{% static 'dashboard.css' %}">
</head>

<body>

<!-- ================= NAVBAR ================= -->
<nav class="navbar">
    <div class="nav-left">
        <div class="logo">
            <div class="logo-mark">A<sup>3</sup></div>
            <div class="logo-divider"></div>
            <div class="logo-text">
                <span>AI Resume</span>
                <small>Intelligence</small>
            </div>
        </div>
    </div>

    <div class="nav-right">
        <div class="user-info">
            <span class="user-icon">ðŸ‘¤</span>
            <span class="username">{{ request.user.username }}</span>
        </div>
        <a href="{% url 'auth' %}" class="logout-btn">Logout</a>
    </div>
</nav>

<div class="background-grid"></div>

<!-- ================= MAIN CONTENT ================= -->
<div class="dashboard">

    <!-- HERO -->
    <div class="hero">
        <h1>
            <span class="hero-brand">AÂ³ </span>
            Amplify Your Resume
        </h1>

        <p>
            Apex your potential. Accelerate your career with AI precision.
        </p>

        <div class="hero-line"></div>

        <p>
            <span id="typing-text"></span>
        </p>
    </div>

    <!-- UPLOAD RESUME -->
    <div class="card upload-card">
        <h2>Upload Resume</h2>

        <form method="POST" action="{% url 'analysis' %}" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="form-group">
                <label>Target Role</label>
                <select name="target_role" required>
                    <option value="">Select Role</option>
                    <option value="backend">Backend Developer</option>
                    <option value="frontend">Frontend Developer</option>
                    <option value="android">Android Developer</option>
                    <option value="ml">Machine Learning Engineer</option>
                    <option value="data">Data Analyst</option>
                </select>
            </div>

            <div class="form-group">
                <label>Experience Level</label>
                <select name="experience_level" required>
                    <option value="">Select Experience</option>
                    <option value="fresher">Fresher</option>
                    <option value="junior">1-3 Years</option>
                    <option value="mid">3-5 Years</option>
                    <option value="senior">5+ Years</option>
                </select>
            </div>

            <div class="form-group">
                <label>Company Type</label>
                <select name="company_type" required>
                    <option value="">Select Company</option>
                    <option value="startup">Startup</option>
                    <option value="product">Product Based</option>
                    <option value="service">Service Based</option>
                    <option value="faang">FAANG</option>
                </select>
            </div>

           <div class="upload-area" id="uploadArea">
                <p id="uploadText">ðŸ“„ Drag & Drop Resume Here</p>
                <span>or click to upload</span>

                <input type="file" name="resume" id="resumeInput" required hidden>

                <p class="section-subtitle">
                    Optimize your resume for ATS and job roles.
                </p>
            </div>

            <button type="submit" class="primary-btn">
                Upload & Analyze
            </button>
        </form>
    </div>

    <!-- UPLOAD HISTORY -->
    <div class="card history-card">
       <h2>Uploaded & Analysis History</h2>
<div class="history-list">
{% if history %}
    {% for analysis in history %}
    <div class="history-item">

        <div class="history-left">
            <div class="resume-name">
                {{ analysis.resume.resume.name|slice:"8:" }}
            </div>
            <div class="resume-date">
                {{ analysis.created_at|date:"M d, Y â€¢ H:i" }}
            </div>
        </div>

        <div class="history-right">
            <div class="score-badge">
                {{ analysis.final_score }}%
            </div>
        </div>

    </div>
    {% endfor %}
{% else %}
    <div class="no-history">
        No resumes uploaded yet.
    </div>
{% endif %}
</div>
    </div>

</div>

<script>
const text = "AI-powered ATS analysis tailored to your target job role.";
let i = 0;

function typing() {
  if (i < text.length) {
    document.getElementById("typing-text").innerHTML += text.charAt(i);
    i++;
    setTimeout(typing, 30);
  }
}
typing();

const uploadArea = document.getElementById("uploadArea");
const resumeInput = document.getElementById("resumeInput");
const uploadText = document.getElementById("uploadText");

// Click upload area â†’ open file picker
uploadArea.addEventListener("click", () => {
    resumeInput.click();
});

// When file selected â†’ show file name
resumeInput.addEventListener("change", function () {
    if (this.files.length > 0) {
        const fileName = this.files[0].name;
        uploadText.innerHTML = "âœ… " + fileName;
        uploadText.style.color = "#f4c430";
        uploadText.style.fontWeight = "600";
    }
});

</script>

</body>
</html>